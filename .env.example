# TronRelic Environment Configuration
# Copy this file to .env and fill in your values
#
# Development Modes:
# - npm mode (./scripts/start.sh --npm): MongoDB/Redis in Docker, backend/frontend via npm
#   Uses localhost connection strings below
# - Docker mode (./scripts/start.sh): All services in Docker containers
#   Docker Compose overrides with service names (mongodb:27017, redis:6379)

# ==============================================
# Droplet Deployment Configuration
# ==============================================
# Required for deployment scripts (./scripts/droplet-*.sh)
# Leave blank if you're only doing local development

# Production droplet IP address
PROD_DROPLET_IP=

# Development droplet IP address
DEV_DROPLET_IP=

# GitHub Container Registry credentials
GITHUB_USERNAME=
GITHUB_REPO=

# ==============================================
# Required - API Security
# ==============================================
# Generate with: openssl rand -hex 32
ADMIN_API_TOKEN=

# ==============================================
# Required - TronGrid API Keys
# ==============================================
# Get from https://www.trongrid.io/
TRONGRID_API_KEY=
TRONGRID_API_KEY_2=
TRONGRID_API_KEY_3=

# ==============================================
# Backend Configuration
# ==============================================
NODE_ENV=development
PORT=4000
ENABLE_SCHEDULER=true
ENABLE_WEBSOCKETS=true

# Database connections
# For npm mode (./scripts/start.sh --npm): Use localhost (connects to Docker containers)
# For Docker mode (./scripts/start.sh): docker-compose.yml overrides with service names
MONGODB_URI=mongodb://127.0.0.1:27017/tronrelic
REDIS_URL=redis://127.0.0.1:6379
REDIS_NAMESPACE=tronrelic

# ==============================================
# Runtime Configuration (Universal Docker Images)
# ==============================================
# See docs/system/system-runtime-config.md for details
#
# SITE_URL sets the initial database default for siteUrl on fresh install
# Used by backend to initialize SystemConfigService when database is empty
#
# Local development:
NEXT_PUBLIC_SITE_URL=http://localhost:3000
#
# Production/Dev servers - set ONE of these in your server's .env:
# SITE_URL=https://tronrelic.com         # Production
# SITE_URL=https://dev.tronrelic.com     # Development
#
# Why both variables exist:
# - NEXT_PUBLIC_SITE_URL: Local dev only (read by backend and used as frontend fallback)
# - SITE_URL: Production/dev servers (cleaner variable name for deployment)
# Docker compose translates SITE_URL â†’ NEXT_PUBLIC_SITE_URL for backend container
#
# Note: Frontend NEXT_PUBLIC_* vars are NOT used in production docker-compose
# because Next.js inlines them at build time. Runtime config is fetched from
# backend API and injected into HTML by SSR instead (universal Docker images).

# ==============================================
# Frontend Configuration (Local Dev Only)
# ==============================================
# These are used as fallback defaults in local development
# Production/dev servers use runtime config from backend API
NEXT_PUBLIC_API_URL=http://localhost:4000/api
NEXT_PUBLIC_SOCKET_URL=http://localhost:4000

# ==============================================
# Production Only (Leave blank for development)
# ==============================================
# Generate with: openssl rand -hex 32 (for each)
MONGO_ROOT_USERNAME=admin
MONGO_ROOT_PASSWORD=
REDIS_PASSWORD=

# ==============================================
# Optional: Telegram Bot Plugin
# ==============================================
# Bot token and webhook secret are now configured via /system/plugins/telegram-bot/settings UI (stored in database)
# 1. Get token from @BotFather on Telegram
# 2. Navigate to /system/plugins in your TronRelic instance
# 3. Enable telegram-bot plugin
# 4. Configure bot token and webhook secret in plugin settings card
#
# Benefits of database-backed configuration:
# - No server restart required for token/secret rotation
# - Secure storage with automatic masking in admin UI
# - Runtime configuration changes via web interface
# - Webhook secret configured via "Generate New Secret" button in admin UI

# Optional: IP allowlist for webhook requests (comma-separated CIDR ranges)
# Default: Telegram's official IP ranges
# TELEGRAM_IP_ALLOWLIST=149.154.160.0/20,91.108.4.0/22

# DEPRECATED: Legacy whale-alerts plugin integration (will be removed)
# Use telegram-bot plugin instead for all Telegram functionality
# TELEGRAM_TOKEN=

# ==============================================
# Backend API URL for Server-Side Rendering (SSR)
# ==============================================
# Used by Next.js server during SSR to fetch data from backend
# Docker mode: Docker Compose overrides this with API_URL=http://backend:4000
# npm mode: Uses this value (http://localhost:4000) or falls back to NEXT_PUBLIC_API_URL
# Leave as localhost for npm mode, Docker Compose will handle the override
API_URL=http://localhost:4000
